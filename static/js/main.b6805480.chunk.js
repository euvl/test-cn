(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{193:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(14),i=n.n(o),s=(n(86),n(27)),l=n(28),c=n(30),u=n(29),d=n(31),p=n(80),f=n(2),m=n(78),h=n.n(m),v=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={positionTop:-1e4,positionLeft:-1e4,focused:null,focusShift:0},n.componentDidMount=function(){n.updatePosition()},n.componentDidUpdate=function(){n.updatePosition()},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=window.document.getElementById("root"),n=this.state,a=n.focused,o={top:n.positionTop,left:n.positionLeft};return i.a.createPortal(r.a.createElement("ul",{className:"suggestion-ul",style:o},this.props.terms.map(function(t){return r.a.createElement("li",{key:t.code,className:h()("suggestion-li",{focused:a===t.code}),onClick:function(){return e.props.onSelect(t)}},r.a.createElement("span",null,t.text))})),t)}},{key:"updatePosition",value:function(){var e=this.props,t=e.anchor,n=e.terms,a=window.document.querySelector(t);if(!a)return this.setState({positionLeft:-1e4,positionTop:-1e4,focused:null});var r=a.getBoundingClientRect(),o=n.length>0?n[0].code:null;this.setState({positionTop:r.bottom,positionLeft:r.left,focused:o})}}]),t}(a.PureComponent),y=n(32),g=function(e){var t=e.children,n=Object(y.a)(e,["children"]);return r.a.createElement("h2",n,t)},x=function(e){var t=e.children,n=Object(y.a)(e,["children"]);return r.a.createElement("p",n,t)},b=function(e){var t=e.terms;return r.a.createElement("div",{className:"term-list"},r.a.createElement("table",null,r.a.createElement("tbody",null,t.map(function(e){return r.a.createElement("tr",{key:e.code},r.a.createElement("td",null,r.a.createElement("b",null,"@",e.code)),r.a.createElement("td",null,e.text))}))))},E={document:{nodes:[{type:"heading"},{type:"paragraph"}],normalize:function(e,t){console.log(t)}},blocks:{paragraph:{nodes:[{match:{object:"text"}}]},heading:{nodes:[{match:{object:"text"}}]}}},k=n(79),w=n.n(k),j=/@(\S*)$/,T="mentionContext",N=function(e){if(!e.startText)return null;var t=e.selection.start.offset,n=e.startText.text.slice(0,t),a=j.exec(n);return null===a?null:a[1]};function S(e){var t=e.document,n=e.selection;return!t.getClosest(n.start.key,function(e){return"paragraph"!==e.type&&"heading"!==e.type})}var O={document:{nodes:[{object:"block",type:"heading",nodes:[{object:"text",leaves:[{text:""}]}]}]}},B={document:{nodes:[{object:"block",type:"paragraph",nodes:[{object:"text",leaves:[{text:""}]}]}]}},H=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).editorRef=r.a.createRef(),n.insertParagraph=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.insertBlock("paragraph").insertText(t).focus()},n.insertHeading=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.insertBlock("heading").insertText(t).focus()},n.insertHeadingWithParagraph=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e.insertBlock("heading").insertText(t).insertBlock("paragraph").insertText(n).focus()},n.insertMention=function(e){var t=n.state.value,a=N(t),r=n.editorRef.current,o=r.value.blocks.first(),i=a.length+1;o&&("heading"===o.type&&r.deleteBackward(t.startText.text.length).insertText(e.text).focus(),"paragraph"===o.type&&(r.removeNodeByKey(o.key),n.insertHeadingWithParagraph(r,e.text,t.startText.text),r.deleteBackward(i).focus()))},n.onKeyDown=function(e,t,a){switch(e.key){case"Enter":return"simple"===n.props.type?a():n.onEnter(e,t,a);case"Tab":return n.onTab(e,t,a);default:return a()}},n.onTab=function(e,t,a){var r=n.state.terms;r&&r.length>0&&n.insertMention(r[0]),e.preventDefault()},n.onEnter=function(e,t,n){var a=t.value,r=a.selection,o=r.start,i=r.end;if(r.isExpanded)return n();var s=a.startBlock;return 0===o.offset&&0===i.offset&&0===s.text.length?(e.preventDefault(),void t.setBlocks("heading")):"heading"!==s.type?n():(e.preventDefault(),void t.splitBlock().setBlocks("paragraph"))},n.search=function(e){n.setState({terms:[]}),e&&(n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout(function(){var t=RegExp("^".concat(e),"gi");n.setState({terms:n.props.options.filter(function(e){return e.text.match(t)||e.code.match(t)})})},50))},n.onChange=function(e){var t=N(e.value);if(t!==n.lastInputValue){n.lastInputValue=t,S(e.value)&&n.search(t);var a=e.value.selection,r=e.value.decorations.filter(function(e){return e.mark.type!==T});return t&&S(e.value)&&(r=r.push({anchor:{key:a.start.key,offset:a.start.offset-t.length},focus:{key:a.start.key,offset:a.start.offset},mark:{type:T}})),void n.setState({value:e.value},function(){n.editorRef.current.setDecorations(r)})}n.setState({value:e.value})},n.renderNode=function(e,t,n){var a=e.attributes,o=e.children,i=e.node;switch(window.editor=t,i.type){case"heading":return r.a.createElement(g,a,o);case"paragraph":return r.a.createElement(x,a,o);default:return n()}};var a=n.props.defaultValue||("simple"===n.props.type?B:O);return n.state={defaultValue:f.m.fromJSON(a),terms:[]},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("label",null,this.props.label),r.a.createElement("div",{className:"layout"},r.a.createElement("div",{className:"layout-left"},r.a.createElement(p.a,{className:"editor",placeholder:"Enter a title...",defaultValue:this.state.defaultValue,schema:"simple"===this.props.type?w.a:E,ref:this.editorRef,renderNode:this.renderNode,renderMark:this.renderMark,onKeyDown:this.onKeyDown,onChange:this.onChange}),r.a.createElement(v,{anchor:".search-word-context",terms:this.state.terms,onSelect:this.insertMention})),r.a.createElement("div",{className:"layout-right"},r.a.createElement(b,{terms:this.props.options}))))}},{key:"renderMark",value:function(e,t,n){return e.mark.type===T?r.a.createElement("span",Object.assign({},e.attributes,{className:"search-word-context"}),e.children):n()}}]),t}(a.Component);H.defaultProps={options:[]};var P=H,C=[{code:"hpc",text:"History of Presenting Complaint"},{code:"pmh",text:"Past Medical History"},{code:"med",text:"Medication History"},{code:"all",text:"Allergies"},{code:"fam",text:"Family History"},{code:"soc",text:"Social History"},{code:"oex",text:"On Examination"},{code:"imp",text:"Impression"},{code:"adv",text:"Advice"},{code:"saf",text:"Safety Netting"}],M={document:{nodes:[{object:"block",type:"heading",nodes:[{object:"text",leaves:[{text:"Heading"}]}]},{object:"block",type:"paragraph",nodes:[{object:"text",leaves:[{text:"This is prototype."}]}]}]}},D=function(){return"?v2"===window.location.search?r.a.createElement("div",null,r.a.createElement(P,{label:"History",options:[{code:"pmh",text:"Past Medical History"},{code:"med",text:"Medication History"},{code:"all",text:"Allergies"},{code:"fam",text:"Family History"},{code:"soc",text:"Social History"}],defaultValue:M}),r.a.createElement("br",null),r.a.createElement(P,{label:"Examination",type:"simple"}),r.a.createElement("br",null),r.a.createElement(P,{label:"Diagnosis",type:"simple"}),r.a.createElement("br",null),r.a.createElement(P,{label:"Plan",options:[{code:"adv",text:"Advice"},{code:"saf",text:"Safety Netting"}],defaultValue:M})):r.a.createElement(P,{label:"Consultation Notes",options:C,defaultValue:M})};i.a.render(r.a.createElement(D,null),document.getElementById("root"))},79:function(e,t){},81:function(e,t,n){e.exports=n(193)},86:function(e,t,n){}},[[81,2,1]]]);
//# sourceMappingURL=main.b6805480.chunk.js.map